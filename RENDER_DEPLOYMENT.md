# Render Deployment Guide (placeHub)

This project is a **3-service** app:

- **Frontend**: Vite/React (static site)
- **Backend**: Node/Express (web service)
- **ML Service**: Flask (web service)
- **Database**: PostgreSQL (Render managed DB)

The repo includes a Render blueprint: `render.yaml`.

---

## 1) Push the code to GitHub

Render deploys from a Git repo. Push this project to GitHub (or any Git provider supported by Render).

---

## 2) Deploy using Render Blueprint (`render.yaml`)

1. Go to Render Dashboard
2. Click **New** → **Blueprint**
3. Select your repo
4. Render will create:
   - `placehub-db` (PostgreSQL)
   - `placehub-backend` (Node)
   - `placehub-ml` (Python)
   - `placehub-frontend` (Static)

---

## 3) Set/Update environment variables on Render

### Backend (`placehub-backend`)

Required:

- **`DATABASE_URL`**: auto-wired from `placehub-db` by the blueprint
- **`JWT_SECRET`**: auto-generated by the blueprint
- **`FRONTEND_URL`**: set to your frontend URL (example: `https://placehub-frontend.onrender.com`)
- **`ML_SERVICE_URL`**: set to your ML service URL (example: `https://placehub-ml.onrender.com`)

Recommended:

- **`DB_SYNC=true`**: auto-creates tables on first deploy (no migrations in repo)
- **`PUPPETEER_SKIP_DOWNLOAD=true`**: prevents heavy Chromium download during build

Optional (only if you use those features):

- Email (SMTP) variables
- OAuth variables (Google/Microsoft)
- Any Uploadcare credentials

### ML Service (`placehub-ml`)

No required secrets for basic health checks.

### Frontend (`placehub-frontend`)

These are **build-time** variables (after changing them, redeploy the frontend):

- **`VITE_API_URL`** = `https://placehub-backend.onrender.com/api`
- **`VITE_ML_API_URL`** = `https://placehub-ml.onrender.com/api`

---

## 4) Verify deployment

- **Frontend**: open the `placehub-frontend` URL
- **Backend health**: `https://<backend>.onrender.com/health`
- **ML health**: `https://<ml>.onrender.com/api/health`

---

## Common Render issues

### Frontend calls wrong API URL

Re-check `VITE_API_URL` / `VITE_ML_API_URL` and **redeploy frontend**.

### Backend DB tables missing

Ensure `DB_SYNC=true` is set for `placehub-backend`, then redeploy backend once.

### Puppeteer build/runtime issues

This repo includes `puppeteer`. If you don’t need it on Render, keep `PUPPETEER_SKIP_DOWNLOAD=true`.
If you _do_ need Puppeteer on Render, you may need additional system libraries or a different approach.

---

## Notes

- `render.yaml` contains placeholder URLs like `https://YOUR_BACKEND_SERVICE.onrender.com`. Replace them in Render after services are created.
